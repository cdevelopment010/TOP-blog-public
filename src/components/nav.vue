<template>
    <nav class="d-flex">
        <div>
            <RouterLink to="/" class="link-none">
                <div class="logo" :class="{dark: darkmode == 'dark'}">
                    <svg viewBox="0 0 475 262" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid meet">
                        <rect width="475" height="262" rx="10" class="rect"/>
                        <path d="M26 49H449V226C449 231.523 444.523 236 439 236H36C30.4771 236 26 231.523 26 226V49Z" class="rect-body"/>
                        <circle cx="36" cy="24" r="10" fill="#6F4E37"/>
                        <circle cx="65" cy="24" r="10" fill="white"/>
                        <circle cx="94" cy="24" r="10" fill="white"/>
                        <path d="M103.535 166.515L73.865 151.68V144.78L103.535 129.945V135.948L82.145 146.436C81.271 146.85 80.443 147.218 79.661 147.54C78.925 147.816 78.373 148 78.005 148.092C78.419 148.184 79.017 148.391 79.799 148.713C80.581 148.989 81.363 149.334 82.145 149.748L103.535 160.305V166.515ZM130.349 171.69C127.313 171.69 124.668 171.115 122.414 169.965C120.206 168.815 118.481 167.159 117.239 164.997C116.043 162.789 115.445 160.19 115.445 157.2V134.43C115.445 131.394 116.043 128.795 117.239 126.633C118.481 124.471 120.206 122.815 122.414 121.665C124.668 120.515 127.313 119.94 130.349 119.94C133.385 119.94 136.007 120.538 138.215 121.734C140.423 122.884 142.125 124.54 143.321 126.702C144.517 128.864 145.115 131.44 145.115 134.43H138.905C138.905 131.578 138.146 129.393 136.628 127.875C135.156 126.311 133.063 125.529 130.349 125.529C127.635 125.529 125.496 126.288 123.932 127.806C122.414 129.324 121.655 131.509 121.655 134.361V157.2C121.655 160.052 122.414 162.26 123.932 163.824C125.496 165.342 127.635 166.101 130.349 166.101C133.063 166.101 135.156 165.342 136.628 163.824C138.146 162.26 138.905 160.052 138.905 157.2H145.115C145.115 160.144 144.517 162.72 143.321 164.928C142.125 167.09 140.423 168.769 138.215 169.965C136.007 171.115 133.385 171.69 130.349 171.69ZM165.236 171.552C162.2 171.552 159.578 170.977 157.37 169.827C155.162 168.677 153.437 167.021 152.195 164.859C150.999 162.651 150.401 160.052 150.401 157.062V146.988C150.401 143.952 150.999 141.353 152.195 139.191C153.437 137.029 155.162 135.373 157.37 134.223C159.578 133.073 162.2 132.498 165.236 132.498C168.272 132.498 170.894 133.073 173.102 134.223C175.31 135.373 177.012 137.029 178.208 139.191C179.45 141.353 180.071 143.929 180.071 146.919V157.062C180.071 160.052 179.45 162.651 178.208 164.859C177.012 167.021 175.31 168.677 173.102 169.827C170.894 170.977 168.272 171.552 165.236 171.552ZM165.236 166.032C167.95 166.032 170.066 165.273 171.584 163.755C173.102 162.237 173.861 160.006 173.861 157.062V146.988C173.861 144.044 173.102 141.813 171.584 140.295C170.066 138.777 167.95 138.018 165.236 138.018C162.568 138.018 160.452 138.777 158.888 140.295C157.37 141.813 156.611 144.044 156.611 146.988V157.062C156.611 160.006 157.37 162.237 158.888 163.755C160.452 165.273 162.568 166.032 165.236 166.032ZM194.879 171V142.503H183.839V136.845H194.879V130.29C194.879 127.3 195.822 124.954 197.708 123.252C199.594 121.504 202.193 120.63 205.505 120.63H216.614V126.288H205.505C204.079 126.288 202.975 126.633 202.193 127.323C201.457 127.967 201.089 128.956 201.089 130.29V136.845H216.614V142.503H201.089V171H194.879ZM230.042 171V142.503H219.002V136.845H230.042V130.29C230.042 127.3 230.985 124.954 232.871 123.252C234.757 121.504 237.356 120.63 240.668 120.63H251.777V126.288H240.668C239.242 126.288 238.138 126.633 237.356 127.323C236.62 127.967 236.252 128.956 236.252 130.29V136.845H251.777V142.503H236.252V171H230.042ZM270.725 171.69C267.735 171.69 265.113 171.092 262.859 169.896C260.651 168.7 258.926 167.021 257.684 164.859C256.488 162.651 255.89 160.098 255.89 157.2V146.85C255.89 143.906 256.488 141.353 257.684 139.191C258.926 137.029 260.651 135.35 262.859 134.154C265.113 132.958 267.735 132.36 270.725 132.36C273.715 132.36 276.314 132.958 278.522 134.154C280.776 135.35 282.501 137.029 283.697 139.191C284.939 141.353 285.56 143.906 285.56 146.85V153.543H261.962V157.2C261.962 160.19 262.721 162.49 264.239 164.1C265.757 165.664 267.919 166.446 270.725 166.446C273.117 166.446 275.049 166.032 276.521 165.204C277.993 164.33 278.89 163.042 279.212 161.34H285.422C285.008 164.514 283.444 167.044 280.73 168.93C278.062 170.77 274.727 171.69 270.725 171.69ZM279.488 149.403V146.85C279.488 143.86 278.729 141.56 277.211 139.95C275.739 138.34 273.577 137.535 270.725 137.535C267.919 137.535 265.757 138.34 264.239 139.95C262.721 141.56 261.962 143.86 261.962 146.85V148.851H279.971L279.488 149.403ZM305.888 171.69C302.898 171.69 300.276 171.092 298.022 169.896C295.814 168.7 294.089 167.021 292.847 164.859C291.651 162.651 291.053 160.098 291.053 157.2V146.85C291.053 143.906 291.651 141.353 292.847 139.191C294.089 137.029 295.814 135.35 298.022 134.154C300.276 132.958 302.898 132.36 305.888 132.36C308.878 132.36 311.477 132.958 313.685 134.154C315.939 135.35 317.664 137.029 318.86 139.191C320.102 141.353 320.723 143.906 320.723 146.85V153.543H297.125V157.2C297.125 160.19 297.884 162.49 299.402 164.1C300.92 165.664 303.082 166.446 305.888 166.446C308.28 166.446 310.212 166.032 311.684 165.204C313.156 164.33 314.053 163.042 314.375 161.34H320.585C320.171 164.514 318.607 167.044 315.893 168.93C313.225 170.77 309.89 171.69 305.888 171.69ZM314.651 149.403V146.85C314.651 143.86 313.892 141.56 312.374 139.95C310.902 138.34 308.74 137.535 305.888 137.535C303.082 137.535 300.92 138.34 299.402 139.95C297.884 141.56 297.125 143.86 297.125 146.85V148.851H315.134L314.651 149.403ZM327.914 178.59L352.409 113.73H358.964L354.479 125.667L394.154 144.78V151.68L364.484 166.515V160.305L385.874 149.886C386.748 149.472 387.553 149.15 388.289 148.92C389.071 148.644 389.646 148.46 390.014 148.368C389.6 148.276 389.002 148.115 388.22 147.885C387.484 147.609 386.702 147.264 385.874 146.85L352.547 130.773L334.469 178.59H327.914Z" fill="#C0A98F"/>
                    </svg>
                </div>
                
                
                
                
            </RouterLink>
        </div>

        <div class="d-flex justify-evenly align-center gap-1">
            <input type="text" placeholder="Search tags or titles" v-model="searchQuery" @keydown.enter="performSearch"/>
            <RouterLink to="/posts" class="btn">Posts</RouterLink>
            <RouterLink to="/tags" class="btn">Tags</RouterLink>
            <RouterLink to="/about" class="btn btn-secondary">About</RouterLink>
            <button class="btn-theme-toggle" @click="toggleDarkMode" style="font-size:1.3rem;">
                <i class="fa-solid fa-moon" v-if="darkmode == 'dark'"></i>
                <i class="fa-solid fa-sun" v-if="darkmode == 'light'"></i>
            </button>
        </div>

    </nav>

</template>

<script setup lang="ts">
    import { RouterLink, useRouter } from 'vue-router';
    import { ref, onMounted } from "vue"; 

    
    const router = useRouter(); 
    const searchQuery = ref('');
    const darkmode=ref<string>(localStorage.getItem('csc-theme') ?? 'light') 

    const performSearch = () => {
        if (searchQuery.value.trim()) {
            router.push({ path: "/posts", query: { query: searchQuery.value.trim() } });
        }
    };

    function toggleDarkMode() {
        const newTheme = darkmode.value == "dark" ? "light" : "dark";
        darkmode.value = newTheme;
        document.documentElement.setAttribute("data-theme", newTheme);
        localStorage.setItem("csc-theme", newTheme);
    }

    onMounted(()=> {
        const savedTheme = localStorage.getItem("csc-theme") || "light";
        darkmode.value = savedTheme;
        document.documentElement.setAttribute("data-theme", savedTheme);
    })

    
</script>

<style scoped>
    nav { 
        display: flex; 
        align-items: center;
        justify-content: space-between;
    }

    .logo svg {
        margin-top: 3px;
        margin-bottom: 3px;
        height: 50px;
        width: auto;
        display: block;
    }

    .logo .rect { 
        fill: var(--text-1)
    }
    .logo .rect-body { 
        fill: var(--background-1)
    }

    .logo.isDark .rect { 
        fill: var(--text-1)
    }


    .btn-theme-toggle {
        background-color: var(--primary-1);
        color: var(--background-1);
        border: none;
        border-radius: 50%;
        width: 2.5rem;
        height: 2.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
    }

    .btn-theme-toggle:hover {
        background-color: var(--primary-2);
        transform: rotate(8deg);
    }

    .btn-theme-toggle:focus {
    outline: none;
    outline-offset: 2px;
    }
    .btn-theme-toggle:focus-visible {
        box-shadow: 0 0 0 2px var(--accent-2);
    }
    .btn-theme-toggle:active {
        transform: scale(0.95);
    }

</style>